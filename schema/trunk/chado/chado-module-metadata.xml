<?xml version="1.0" encoding="ISO-8859-1"?>
<schema_metadata id='chado'>

  <title>Chado: A generic model organism database schema</title>
  <description>
    Chado is a modular schema for biological data
  </description>
  <about>
    This is a metadata file describing chado and its components,
    specified in XML. The path to each module SQL file is described,
    as well as other files which that module may require or use
  </about>

  <!-- source types -->
  <!--  dir: a directory relative to the chado root dir -->
  <!--  sql: SQL DDL statements that are largely DBMS neutral-->
  <!--  plpgsql: PostgreSQL functions and triggers -->
  <!--  bridge-xml: Can be converted with chado/bin/create-bridge-sql.pl -->
  <!--  sqlapi: Pseudo-SQL public function interface declarations -->
  <!-- -->

  <modules>
    <source type='dir' path='modules'/>

    <module id='general' required='true'>
      <description>
        General purpose tables, including dbxrefs
      </description>
      <source type='sql' path='general/general.sql'/>

      <component id='general-loading-api' type='dbapi'>
        <description>
          A DBMS API for the general module's loading functions
        </description>
        <source type='sqli' path='general/functions/general-loading.sqlapi'/>
      </component>

      <component id='general-loading' type='code'>
        <description>
          Postgres code for helping with loading the general module
        </description>
        <implements to='general-loading-api'/>
        <source type='plpgsql' path='general/functions/general-loading.plpgsql'/>
      </component>


    </module>

    <module id='cv' required='true'>
      <dependency to='general'/>
      <description>
        Controlled vocabularies and ontologies
      </description>
      <source type='sql' path='cv/cv.sql'/>

      <component id='cv-views' type='views' required='true'>
        <description>
          Standard Chado SQL Views for the cv module
        </description>
        <source type='sql' path='cv/views/cv-views.sql'/>
      </component>

      <component id='cv-dbapi' type='dbapi'>
        <description>
          A DBMS API for the cv module
        </description>
        <source type='sqli' path='cv/cv-dbapi.sqli'/>
      </component>

      <component id='cv-subj-obj' type='code'>
        <description>
          Postgres code for finding parent and child cvterms
        </description>
        <source type='plpgsql' path='cv/functions/get_subj_obj_ids.plpgsql'/>
      </component>

      <component id='cv-funcs' type='code'>
        <description>
          Postgres code for populating the cvtermpath table
        </description>
        <implements to='cv-dbapi'/>
        <source type='plpgsql' path='cv/functions/fill_cvtermpath.plpgsql'/>
      </component>

      <component id='cv-cycle' type='code'>
        <description>
          Postgres code for working with cvterm cycles
        </description>
        <source type='plpgsql' path='cv/functions/detect_cycle.plpgsql'/>
      </component>


    </module>

    <module id='organism' required='true'>
      <dependency to='general'/>
      <dependency to='cv'/>
      <description>
        Species data - does not include phylogeny
      </description>
      <source type='sql' path='organism/organism.sql'/>

      <component id='organism-dbapi' type='dbapi'>
        <description>
          A DBMS API for the organism module
        </description>
        <source type='sqli' path='organism/functions/organism.sqlapi'/>
      </component>

      <component id='organism-funcs' type='code'>
        <description>
          Postgres code retrieving organism data
        </description>
        <implements to='organism-dbapi'/>
        <source type='plpgsql' path='organism/functions/organism.plpgsql'/>
      </component>

      <component id='organism-loading' type='code'>
        <description>
          Postgres code for helping with loading organism data
        </description>
        <source type='plpgsql' path='organism/functions/organism-loading.plpgsql'/>
      </component>
    </module>

    <module id='pub' required='true'>
      <dependency to='general'/>
      <dependency to='cv'/>
      <description>
        Bibliographic data on publications
      </description>
      <source type='sql' path='pub/pub.sql'/>
    </module>

    <module id='sequence' required='true'>
      <dependency to='general'/>
      <dependency to='organism'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <description>
        Sequence and sequence features, their localization and properties
      </description>
      <source type='sql' path='sequence/sequence.sql'/>

      <component id='gencode' type='sql' required='true'>
        <description>
          Genetic code - maps codons to amino acids according to
          species specific translation table
        </description>
        <source type='sql' path='sequence/gencode/gencode.sql'/>
        <source type='sqldump' path='sequence/gencode/gencode_data.sql'/>
      </component>

      <component id='sequence-dbapi' type='dbapi'>
        <dependency to='gencode'/>
        <description>
          A SQL/DBMS API for the sequence module. Currently only plpgsql
          implementations exist
        </description>
        <!-- subcomponents -->
        <component id='sequence-dbapi-range' type='dbapi'>
          <description>
            Functions for operating on interval ranges
          </description>
          <source type='sqlapi' path='sequence/functions/range.sqlapi'/>
          <source type='plpgsql' path='sequence/functions/range.plpgsql'/>
        </component>
        <component id='sequence-dbapi-sequtil' type='dbapi'>
          <dependency to='gencode'/>
          <description>
            Utility functions for biological sequences
          </description>
          <source type='sqlapi' path='sequence/functions/sequtil.sqlapi'/>
          <source type='plpgsql' path='sequence/functions/sequtil.plpgsql'/>
        </component>
        <component id='sequence-dbapi-locgraph' type='dbapi'>
          <description>
            Projections on graph defined by featureloc
          </description>
          <source type='sqlapi' path='sequence/functions/locgraph.sqlapi'/>
          <source type='plpgsql' path='sequence/functions/locgraph.plpgsql'/>
        </component>
        <component id='sequence-dbapi-cv-helper' type='dbapi'>
          <description>
            feature types
          </description>
          <source type='sqlapi' path='sequence/functions/sequence-cv-helper.sqlapi'/>
          <source type='plpgsql' path='sequence/functions/sequence-cv-helper.plpgsql'/>
        </component>
      </component>

      <component id='feature-util-api' type='dbapi'>
        <description>
          A DBMS API for general feature queries
        </description>
        <source type='sqli' path='sequence/functions/feature.sqlapi'/>
      </component>

      <component id='feature-util' type='code'>
        <dependency to='sequence-dbapi'/>
        <description>
          Postgres code for general feature queries
        </description>
        <implements to='feature-util-api' />
        <source type='plpgsql' path='sequence/functions/feature.plpgsql'/>
      </component>

      <component id='sequence_opt' type='optimizations'>
        <description>
          Optional optimizations to be applied to the sequence module
        </description>
        <source type='sql-in-xml' path='sequence/sequence_opt.xml'/>
      </component>

      <component id='godb-bridge' type='bridge'>
        <description>
          Views that let Chado masquerade as a GO Database. 
          Note that this is a component of the sequence module, as the
          views are over both cv and sequence modules
        </description>
        <status code='alpha'>
          Requires testing with AmiGO
        </status>
        <source type='bridge-xml' path='cv/bridges/godb-bridge.sql.xml'/>
      </component>

      <component id='chaos-bridge' type='bridge'>
        <description>
          Chaos is a simplified layer over chado
        </description>
        <status code='alpha'/>
        <source type='bridge-xml' path='sequence/bridges/chaos-bridge.sql'/>
      </component>

    </module>

    <module id='companalysis'  required='true'>
      <!--added required, since sequence_views is requred and it depends on companalysis-->
      <dependency to='general'/>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <description>
        Augments sequence module with descriptions of computational
        analyses and features resulting from those analyses
      </description>
      <source type='sql' path='companalysis/companalysis.sql'/>

      <component id='companalysis-loading-api' type='dbapi'>
        <description>
          A DBMS API for the companalysis module's loading functions
        </description>
        <source type='sqli' path='companalysis/functions/companalysis-loading.sqlapi'/>
      </component>

      <component id='companalysis-loading' type='code'>
        <description>
          Postgres code for helping with loading the companalysis module
        </description>
        <implements to='companalysis-loading-api'/>
        <source type='plpgsql' path='companalysis/functions/companalysis-loading.plpgsql'/>
      </component>

    </module>

    <module id='genetic'>
      <dependency to='general'/>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <status code='beta'>
        In use right now in FlyBase
      </status>
      <description>
        Genetic and phenotypic data
      </description>
      <source type='sql' path='genetic/genetic.sql'/>
    </module>

    <module id='map'>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <status code='alpha'>
        Not yet in production use anywhere?
      </status>
      <description>
        Non-sequence maps: genetic, radiation hybrid, cytogenetic, etc
      </description>
      <source type='sql' path='map/map.sql'/>
    </module>

<!--
    This module isn't in cvs
    <module id='event'>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <status code='pre-alpha'>
        discussion stage
      </status>
      <description>
        Pathways and quantitative models
      </description>
      <source type='sql' path='event/event.sql'/>
    </module>
-->

    <module id='phylogeny'>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <dependency to='general'/>
      <dependency to='organism'/>
      <status code='beta'>
        In use at IRRI
      </status>
      <description>
        For representing phylogenetic trees; the trees represent the
        phylogeny of some some kind of sequence feature (mainly
        proteins) or actual organism taxonomy trees
      </description>
      <source type='sql' path='phylogeny/phylogeny.sql'/>

      <component id='phylogeny-dbapi' type='dbapi'>
        <description>
          A DBMS API for the phylogeny module
        </description>
        <source type='sqli' path='phylogeny/functions/phylo.sqlapi'/>
      </component>

      <component id='phylogeny-funcs' type='code'>
        <description>
          Postgres code retrieving phylogeny data
        </description>
        <implements to='phylogeny-dbapi'/>
        <source type='plpgsql' path='phylogeny/functions/phylo.plpgsql'/>
      </component>


    </module>

    <module id='contact'>
      <dependency to='cv'/>
      <dependency to='general'/>
      <status code='alpha'>
        In use at UCLA/Allen Day
      </status>
      <description>
        model persons, institutes, groups, organizations, etc
      </description>
      <source type='sql' path='contact/contact.sql'/>
    </module>


    <module id='expression'>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <dependency to='general'/>
      <status code='alpha'>
        In use at UCLA/Allen Day
      </status>
      <description>
        transcript or protein expression data
      </description>
      <source type='sql' path='expression/expression.sql'/>
    </module>

    <module id='rad'>
      <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <dependency to='general'/>
      <status code='beta'>
        In use at UCLA/Allen Day
      </status>
      <description>
        Alternative expression module, based on MAGE model
      </description>
      <source type='sql' path='expression/rad.sql'/>
    </module>

    <module id='composite'>
      <status code='beta'>
      </status>
      <description>
          A collection of bridge codes that have multiple dependancies
          so they don't happily go where is most obvious
      </description>

      <component id='gff-bridge' type='bridge'>
        <dependency to='pub'/>
        <dependency to='sequence'/>
        <dependency to='companalysis'/>
        <dependency to='cv'/>
        <dependency to='sequence-dbapi'/>
        <description>
          A GFF-view over chado. Required by Gbrowse
        </description>
        <source type='sql' path='sequence/gff-bridge/sequence-gff-views.sql'/>
        <source type='plpgsql' path='sequence/gff-bridge/sequence-gff-funcs.plpgsql'/>
      </component>

      <component id='sequence-views' type='views' required='true'>
        <dependency to='sequence'/>
        <dependency to='companalysis'/>
        <dependency to='cv'/>
        <description>
          Standard Chado SQL Views for the sequence module
        </description>
        <source type='sql' path='sequence/sequence_views.sql'/>
        <component id='range-views' type='views' required='true'>
          <description>
            Views for operating on featureloc ranges. Overlap,
            intersection, union, difference etc
          </description>
          <source type='sql' path='sequence/views/range-views.sql'/>
        </component>
      </component>


    </module>


<!--
    Since this is dynamically generated from a given schema, this should
    either be done at a later step, or if requested, dynamically generated
    at run time after the rest of the schema has been generated
    <module id='audit'>
     <dependency to='sequence'/>
      <dependency to='cv'/>
      <dependency to='pub'/>
      <dependency to='general'/>
      <dependency to='companalysis'/>
      <dependency to='contact'/>
      <dependency to='expression'/>
      <dependency to='event'/>
      <dependency to='genetic'/>
      <dependency to='library'/>
      <dependency to='map'/>
      <dependency to='organism'/>
      <dependency to='phylogeny'/>
      <dependency to='rad'/>

      <status code='beta'>
        In use at...?
      </status>
      <description>
        Table auditing for whole database; autogenerated tables
      </description>
      <source type='sql' path='audit/audit_tables.sql'/>
    </module>
-->
  </modules>
</schema_metadata>
