<doc>
  
  
  <a name="canonical-gene-model"></a><div class="scenario">
<div class="id">canonical-gene-model</div>
<div class="summary">The "central dogma" gene model - gene makes mRNA makes
      polypeptide</div>
<div class="description">
      <p>
        For many people this may be the only data they store in
        Chado. The typical protein coding gene model consists of a
        gene, one or more mRNAs, one or more exons, and at least one
        polypeptide.
      </p>
      <p>
        Alternately spliced genes have a 1 to many relation between
        gene and mRNA. Exons can be part_of more than one mRNA. No two
        distinct exon rows should have exact same featureloc
        coordinates (this indicates they are the same exon).
      </p>
      <p>
        Every <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature">feature</a></span> must have a <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#featureloc">featureloc</a></span> with rank=0 and locgroup=0. The value of
        the srcfeature_id column should be identical (i.e. all
        features are located relative to the same feature), except in
        rare circumstances such as when a feature crosses two
        contigs. Software is not guaranteed to support this. The
        srcfeature_id can point to a <span class="term"><a href="http://song.sourceforge.net/#contig">contig</a></span>, a
        <span class="term"><a href="http://song.sourceforge.net/#chromosome">chromosome</a></span><span class="term"><a href="http://song.sourceforge.net/#chromosome_arm">chromosome_arm</a></span> or other
          appropriate assembly unit. 
      </p>
    </div>
<div class="parts">
<h4>This scenario involves rows in the following tables:</h4>
<table>
<th>table</th>
<th>type_id</th>
<th>number</th>
<th>comments</th>
<tr>
<td href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature">feature</td>
<td><b>SO:gene</b></td>
<td>1</td>
<td><span class="comment"><comment>The gene must always be provided</comment></span></td>
</tr>
<tr>
<td href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature">feature</td>
<td><b>SO:mRNA</b></td>
<td></td>
<td><span class="comment"><comment>
          One or more transcripts are required, and these are always
          of type <span class="term"><a href="http://song.sourceforge.net/#mRNA">mRNA</a></span> for protein-coding genes.
        </comment></span></td>
</tr>
<tr>
<td href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature">feature</td>
<td><b>exon</b></td>
<td></td>
<td><span class="comment"><comment>
          Exons are always required, even if the genome under
          consideration has no introns
        </comment></span></td>
</tr>
<tr>
<td href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature">feature</td>
<td><b>polypeptide</b></td>
<td></td>
<td><span class="comment"><comment>
          A protein-coding gene always produces a polypeptide, by
          definition. The polypeptide is located relative to the same
          genomic feature as the exons, mRNAs and gene. A single
          featureloc is used, with fmin and fmax indicating the start
          and stop codon positions (location is inclusive of stop
          codon). The polypeptide sequence should be specified as an
          amino acid sequence.
        </comment></span></td>
</tr>
</table>
</div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: supported</div>
</div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: supported</div>
</div>
<div class="example">
<h4>Example</h4>
<img src="."><span class="download">Download: </span>
</div>
</div>

  <a name="noncoding-gene"></a><div class="scenario">
<div class="id">noncoding-gene</div>
<div class="summary">Similar to <a href="#canonical-gene-model">canonical-gene-model</a>, except with
      noncoding-RNA</div>
<div class="description">
      <p>
        Not all genes are protein-coding. Genes can code for tRNA,
        miRNA, snoRNA, etc. A noncoding gene model is identical to a
        <a href="#canonical-gene-model">canonical-gene-model</a>, with the following
        exceptions:
        <ul>
          <li>There is no polypeptide feature</li>
          <li>Instead of an mRNA feature, there is a feature that is
            some other sub-type of <span class="term"><a href="http://song.sourceforge.net/#RNA">RNA</a></span>
</li>
        </ul>
      </p>
        </div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: supported</div>
</div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: supported</div>
</div>
</div>

  <a name="pseudogene"></a><div class="scenario">
<div class="id">pseudogene</div>
<div class="summary">A pseudogene is a non-functional relic of a
      gene</div>
<div class="description">
      See <span class="term"><a href="http://song.sourceforge.net/#pseudogene">pseudogene</a></span>. A pseudogene may look like an
      ordinary gene, and may even have discernable parts such as
      exons. It may sometimes be desirable to annotate the exon
      structure of a pseudogene - this can in principle be done using
      SO types such as <span class="term"><a href="http://song.sourceforge.net/#decayed_exon">decayed_exon</a></span>. In practice no-one
      is using Chado to do this. There are currently two practices:
      <ul>
        <li>pseudogenes are treated analagously to <a href="#noncoding-gene">noncoding-gene</a>s. That is, there are normal "gene"
        and "exon" features. However, in place of a subtype of RNA,
        there is a feature of type pseudogene. This practice is
        STRONGLY DISCOURAGED (it is not compliant with the relations
        in SO, it gives false counts to the number of real genes in
        the database). Note that this is the current default for
        FlyBase.
        </li>
        <li>
          Pseudogenes are normal <a href="#singleton-feature">singleton-feature</a>s. There is no annotation of
          exon structure. This practice is encouraged. If at a later
          date it becomes desirable to annotated the exon structure of
          a pseudogene, it will be compatible with this.
        </li>
      </ul>
    </div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: unclear</div>
      Apollo by default treats pseudogenes using the first method,
      above. It may also be possible to configure it to the second,
      singleton, method. Annotating the exon structure of pseudogenes
      the correct way has not yet been attempted to our knowledge.
    </div>
</div>

  <a name="singleton-feature"></a><div class="scenario">
<div class="id">singleton-feature</div>
<div class="summary">Many types of features are singletons - that is they are
    not related to other features through
    feature_relationships. Storage of these is basic and as one may
    expect</div>
<div class="description">
      Singleton features present no major problems. Unlike genes,
      which typically have parts (with the parts having subparts),
      singletons do not form feature graphs (or rather, they form
      feature graphs consisting of single nodes). Singleton features
      are located relative to other features (usually the genome, but
      once can have singletons that are located relative to other
      features - this may not be supported by all applications)
    </div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: suppported</div>
</div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: suppported</div>
      Apollo supports singletons provided they are located relative to
      the genome (singletons located relative to other features will
      be ignored). It may be necessary to configure apollo to make the
      feature type "1-level"
    </div>
</div>

  <a name="dicistronic-gene"></a><div class="scenario">
<div class="id">dicistronic-gene</div>
<div class="summary">A dicistronic gene is a gene with a mRNA that codes for
      two distinct non-overlapping CDSs</div>
<div class="description">
      <p>
        Dicistronic genes (see for example, the dmel Adh and Adhr
        genes) have totally distinct gene products deriving from the
        same transcript. To confuse matters, the two polypeptides are
        commonly refered to as being derived from two distinct genes
        (e.g. Adh and Adhr). The entire genomic region comprising the
        transcript (e.g. Adh+Adhr) that includes both CDSs is refered
        to as the <span class="term"><a href="http://song.sourceforge.net/#gene_cassette">gene_cassette</a></span>. In a database such as
        FlyBase, there are 3 gene IDs stored in the database - one for
        each of the two non-overlapping genes, and one for the gene
        cassette
      </p>
      <p>
        Dicistronic genes make it difficult to have a formal
        definition of gene that corresponds nicely with how biologists
        use the term. 
      </p>
      <p>
        There are currently two proposals for handling dicistronic
        genes. The first is a hack and introduces redundancy, but works
        well with existing software and tools. The second is prefered
        from a modeling standpoint, but introduces a lot of complexity
        to software
      </p>
    </div>
</div>

  <a name="operon"></a><div class="scenario">
<div class="id">operon</div>
<div class="summary">Bacterial genes are often transcribed in groups; eg LacZ</div>
<div class="description">
      There are many similarities with <a href="#dicistronic-gene">dicistronic-gene</a>s here.
    </div>
</div>

  <a name="trans-spliced-gene"></a><div class="scenario">
<div class="id">trans-spliced-gene</div>
<div class="summary">A trans-spliced gene has one or more transcripts in which
    that transcript may be spliced together from different parts of the
      genome
    </div>
<div class="description">
      <p>
      A trans spliced transcript is spliced from exons coming from
      different parts of the genome. The distance between each trans
      spliced part may be large, or it may be in the same location on
      the opposite strand.
      </p>
      <p>
      Most C elegans genes have a trans spliced
      leader sequence. This is different from the trans splicing
      involved in dmel <fb name="mod(mdg4)"></fb>, where we observe what
      appears to be two transcripts on separate strands (both
      containing coding sequence) joining together in a single
      functional transcript
      </p>
      <p>
        There are two proposals for dealing with this. One treats the
        trans spliced transcript as a single transcripts, with
        exons coming from different locations. The other treats the
        trans spliced transcript as a mature transcript created from
        two distinct primary transcripts. Note that these proposals
        focus on the dmel example. A solution for the C elegans
        example is not proposed (not sure if we even need one?)
      </p>
      <proposal id="trans-spliced-gene-mixed-exons">
        <div class="summary">
          We treat this as an ordinary gene model, but relax our rules
          for exon locations in a transcript
        </div>
        <div class="description">
          For example, for the canonical Dmel trans spliced gene, we
          would allow transcripts to have exons on different
          strands. Note that in Chado, exon ordering comes from <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature_relationship">feature_relationship</a></span>.rank (between exon and
          transcript), NOT from the featureloc of the exon. Chado has no
          problem with this. However, some software may make assumptions
          that all exons are on the same strand, or may try to order
          exons by their location to get a transcript sequence. This
          software will have unintended consequences with trans spliced
          genes modeled using this proposal
        </div>
        <div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: unclear</div>
          apollo may accidentally scramble the order of exons. Need to
          check
        </div>
        <div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: unclear</div>
          Not sure.
        </div>
      </proposal>
      <proposal id="trans-spliced-gene-mixed-transcripts">
        <div class="summary">
          We would introduce extra transcripts, and have relations
          between the transcripts. Only the mature, spliced,
          transcript would have a relation to the polypeptide
        </div>
        <div class="description">
          This may model the biology better. However, it introduces
           a major departure from the <a href="#canonical-gene-model">canonical-gene-model</a>. For this reason this
          proposal is unlikely to be adopted
        </div>
      </proposal>
    </div>
</div>

  <a name="gene-with-regulatory-elements"></a><div class="scenario">
<div class="id">gene-with-regulatory-elements</div>
<div class="summary">regulatory elements may be implicitly or explicitly
      associated with a gene</div>
</div>

  <a name="transposons"></a><div class="scenario">
<div class="id">transposons</div>
<div class="summary">transposons can be annotated as <a href="#singleton-feature">singleton-feature</a>s or as complex annotations</div>
<div class="description">
      <p>
        A transposon may consist of various parts such as <span class="term"><a href="http://song.sourceforge.net/#long_terminal_repeat">long_terminal_repeat</a></span>s and gene models coding for genes
        like gag, pol, env. These parts may have all decayed over
        time. Transposon annotation typically ignores these subtleties
        as all that is usually required is a <a href="#singleton-feature">singleton-feature</a> of type <span class="term"><a href="http://song.sourceforge.net/#transposable_element_feature">transposable_element_feature</a></span>. In this case, there is no
        difficulty
      </p>
      <p>
        If one requires detailed transposon annotation then one is
        entering uncharted water as far as both Chado and annotation
        tools are concerned (which is why this scenario is marked as
        being under discussion). One option would be to treat each
        transposon part as distinct singletons, but this may be
        unsatisfactory as one may desire to have the appropriate
        part_of relations between the parts.
      </p>
    </div>
</div>

  <a name="P-element-insertions"></a><div class="scenario">
<div class="id">P-element-insertions</div>
<div class="summary"></div>
</div>

  <a name="SNPs"></a><div class="scenario">
<div class="id">SNPs</div>
<div class="summary"></div>
</div>

  <a name="gene-with-implicit-features-manifested"></a><div class="scenario">
<div class="id">gene-with-implicit-features-manifested</div>
<div class="summary">Some feature types such as introns are not normally
      manifested as rows in chado. They are normally derived
      on-the-fly from the gaps between consecutive exons. See <span class="table"></span> for an example. Occasionally it may be
      desirable to store the introns actual rows in the feature table
      - for scenario in a report database</div>
</div>

  <a name="feature-localization"></a><div class="scenario">
<div class="id">feature-localization</div>
<div class="summary">All features with sequence annotation should be localized
    using featureloc</div>
<div class="description">
      <p>
        localized features must have a <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#featureloc">featureloc</a></span> with
        rank=0 and locgroup=0. This is the primary location of the
        feature. The location always indicates the boundaries of the
        feature. If the feature is composed of distinct subfeatures
        (e.g. a transcript composes of exons), then it is NOT permitted
        to use multiple featurelocs to indicate this. Instead, there
        must be rows for the subfeatures, each with their own
        featureloc
      </p>
      <p>
        In a feature graph (i.e. a group of features connected via
        <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#feature_relationship">feature_relationship</a></span> rows, all features will
        typically be localized relative to the same source feature
        (i.e. they will all have the same value for
        featureloc.srcfeature_id)
      </p>
      <p>
        features are typically localized to some kind of genomic or
        assembly feature, but chado does not constrain you to using
        only this. For example, localizing features relative to a
        transcript or polypeptide or even exon is permitted, but
        unusual practices will most likely not be recognized by most
        software
      </p>
    </div>
</div>

  <a name="feature-localization-to-contigs-in-assembly"></a><div class="scenario">
<div class="id">feature-localization-to-contigs-in-assembly</div>
<div class="summary">In an assembled genome, it is common to locate relative
      to the top-level assembly units (e.g. chromosomes). However, it
      is also permissable to locate to smaller units such as <span class="term"><a href="http://song.sourceforge.net/#contig">contig</a></span>s or <span class="term"><a href="http://song.sourceforge.net/#golden_path_unit">golden_path_unit</a></span>s</div>
<div class="description">
      <p>
        If a genome assembly is not stable, it is common to locate
        relative to assembly units such as <span class="term"><a href="http://song.sourceforge.net/#contig">contig</a></span>s. These
        contigs may then be localized relative to the top-level assembly
        units. This is known in chado terms as a <b>location
          graph</b>.
      </p>
      <p>We discuss here location graphs of depth 2. See also <a href="#n-level-assemblies">n-level-assemblies</a>. This scenario is often
        invisible to software interoperating with Chado. The software
        is free to only look at the main features and the contig-level
        feature and ignore the top-level assembly feature. It may
        sometimes be desirable to have software that can perform
        location transformations, mapping features from contigs to
        top-level units and back
      </p>
    </div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: unclear</div>
      apollo should be happy to treat contigs just as if they were
      top-level units as chromosome arms. However, the user may have
      to explicitly provide contigs if location queries are
      desired. For example, apollo may retrieve nothing if the user
      asks for a certain range on chromosome 4, and the features are
      located relative to contigs which are themselves on chromosome 4.
    </div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: unclear</div>
      Gbrowse may expect features to be located relative to top-level
      units such as chromosomes.
    </div>
</div>

  <a name="redundant-localizations-to-different-assembly-levels"></a><div class="scenario">
<div class="id">redundant-localizations-to-different-assembly-levels</div>
<div class="summary">Features can be located relative to both contigs and
      top-level assembly units</div>
<div class="description">
      <p>
        Chado allows redundant feature localization using <span class="table"><a href="http://gmod.sourceforge.net/schema/doc/default_schema.html#featureloc">featureloc</a></span>.locgroup&gt;0. This allows a database to have
        primary locations for features relative to contigs, and
        secondary locations relative to top-level units such as
        chromosomes. The converse is also allowed.
      </p>
      <p>
        This scenario is discouraged unless the chado db admin knows
        what they are doing. They must implement solutions to ensure
        that featurelocs with varying locgroup do not get out of
        sync. These solutions are not part of the standard Chado
        software suite. Nevertheless, this scenario may be useful for
        advanced users in certain circumstances
      </p>
    </div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: unclear</div>
      Not clear if gbrowse uses locgroup in querying. If it constrains
      by locgroup, then this is essentially the same as 
      <a href="#feature-localization-to-contigs-in-assembly">feature-localization-to-contigs-in-assembly</a>
    </div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: partial</div>
      Not clear if apollo uses locgroup in querying. If it constrains
      by locgroup, then this is essentially the same as <a href="#feature-localization-to-contigs-in-assembly">feature-localization-to-contigs-in-assembly</a>. Apollo
      will not preserve redundant featurelocs when writing back to
      db. This could lead to db getting out of sync.
    </div>
</div>

  <a name="n-level-assemblies"></a><div class="scenario">
<div class="id">n-level-assemblies</div>
<div class="summary">In theory it is possible (but rare) to have assemblies with variable
    depths, or with depths&gt;2</div>
<div class="description">
      This scenario is rare. If required, then Chado can deal with
      this - there is no theoretical limit to the depth of a location
      graph. One can have annotated features located relative to
      minicontigs which are located relative to supercontigs which are
      located relative to chromosomes. Most software that
      interoperates with Chado will not be able to deal with this, so
      this scenario is discouraged except by advanced users who have
      no other option
    </div>
</div>

  <a name="unlocalized-gene"></a><div class="scenario">
<div class="id">unlocalized-gene</div>
<div class="summary">A gene without sequence based localization</div>
<div class="description">
      <p>
        Many chado instances are purely concerned with genome annotation
        - in these cases it would be strange to have genes or other
        features such as transcripts with no localization (i.e. no
        featurelocs). However, this scenario is actually common when
        Chado is used in a wider context. We may of the existence of
        genes through non-sequence evidence such as genetics. When we
        have no sequence-based localization it is perfectly valid to
        have gene features with no featurelocs. When the time comes to
        create genome annotations for these, we just 'fill out' the gene
        feature by adding transcript and exon features.
      </p>
    </div>
<div class="support">
<div class="tool">Tool: gbrowse</div>
<div class="status">Status: supported</div>
      Gbrowse supports this scenario in that unlocalized features will
      be ignored from the genome viewer, which is appropriate
    </div>
<div class="support">
<div class="tool">Tool: apollo</div>
<div class="status">Status: supported</div>
      Apollo supports this scenario in that unlocalized features will
      be ignored, which is appropriate behaviour for a genome
      annotation tool
    </div>
</div>
  
</doc>
